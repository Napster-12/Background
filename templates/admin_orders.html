<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Admin - Orders</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">
<style>
body { font-family: 'Poppins', sans-serif; background: #f7f9fb; }
.container { margin-top: 80px; }
table { background: #fff; border-radius: 12px; box-shadow: 0 5px 25px rgba(0,0,0,0.05); }
th, td { vertical-align: middle !important; }
.status-select { width: 150px; }
.send-email-btn { margin-left: 10px; }
</style>
</head>
<body>

<div class="container">
  <h2 class="mb-4">All Orders</h2>

  <table class="table table-hover table-bordered">
    <thead class="table-light">
      <tr>
        <th>Order ID</th>
        <th>Client Name</th>
        <th>Email</th>
        <th>Items</th>
        <th>Total (R)</th>
        <th>Status</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody>
      {% for order in orders %}
      <tr>
        <td>{{ order.id }}</td>
        <td>{{ order.billing_name }}</td>
        <td>{{ order.billing_email }}</td>
        <td>
          <ul>
            {% for item in order.items %}
            <li>{{ item.name }} x {{ item.quantity }}</li>
            {% endfor %}
          </ul>
        </td>
        <td>{{ order.total }}</td>
        <td>
          <form method="POST" action="/admin/update_status/{{ order.id }}">
            <select name="status" class="form-select status-select" onchange="this.form.submit()">
              <option value="Pending" {% if order.status=='Pending' %}selected{% endif %}>Pending</option>
              <option value="Processing" {% if order.status=='Processing' %}selected{% endif %}>Processing</option>
              <option value="Shipped" {% if order.status=='Shipped' %}selected{% endif %}>Shipped</option>
              <option value="Delivered" {% if order.status=='Delivered' %}selected{% endif %}>Delivered</option>
              <option value="Cancelled" {% if order.status=='Cancelled' %}selected{% endif %}>Cancelled</option>
            </select>
          </form>
        </td>
        <td>
          <form method="POST" action="/admin/send_email/{{ order.id }}">
            <button type="submit" class="btn btn-sm btn-primary send-email-btn">
              <i class="bi bi-envelope-fill"></i> Send Email
            </button>
          </form>
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
